<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>ROS: AirSim ROS 包装器 - 低空模拟器</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "ROS: AirSim ROS \u5305\u88c5\u5668";
        var mkdocs_page_input_path = "airsim_ros_pkgs.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 低空模拟器
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">主页</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 AirSim</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../use_precompiled/">下载二进制文件</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">在 Windows 上构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">在 Linux 上构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_macos/">在 macOS 上构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../docker_ubuntu/">Linux 上的 Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../azure/">Azure 上的 ArSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_custenv/">定制虚幻引擎环境</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">场景问题和回答</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">使用 AirSim</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../apis/">核心 APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../image_apis/">图像 APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../apis_cpp/">C++ APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../api_docs/html/index.html">API 参考文档</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wiki/">Wiki 文档</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev_workflow/">开发工作流</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../settings/">设置</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../map/">地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../camera_views/">相机视角</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../using_car/">汽车模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../remote_control/">远程控制</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../xbox_controller/">XBox 控制器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../steering_wheel_installation/">方向盘</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multi_vehicle/">多车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >传感器</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../sensors/">传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../lidar/">激光雷达</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../distance_sensor/">距离传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../InfraredCamera/">红外相机</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">ROS: AirSim ROS 包装器</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_1">安装</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_2">构建</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">运行</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#airsim-ros">使用 AirSim ROS 包装器</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#airsim-ros_1">AirSim ROS 包装器节点</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#_4">发布者：</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_5">订阅者:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_6">服务:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_7">参数:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pid">简单 PID 位置控制器节点</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#_8">参数:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_9">服务:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_10">订阅者:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_11">发布者:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_12">全局参数</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_13">杂项</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#wsl1-wsl2-windows10">使用 WSL1 或 WSL2 在 Windows10 上设置构架环境</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#wsl1-vs-wsl2">WSL1 vs WSL2</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#wsl-setup-steps">WSL Setup steps</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#file-system-access-between-wsl-and-windows10">File System Access between WSL and Windows10</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#how-to-run-airsim-on-windows-and-ros-wrapper-on-wsl">How to run Airsim on Windows and ROS wrapper on WSL</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#using-docker-for-ros">Using Docker for ROS</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../airsim_tutorial_pkgs/">ROS: AirSim 教程包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gazebo_drone/">导入 Gazebo 模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../retexturing/">域随机化</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../meshes/">网格顶点缓冲区</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../playback/">播放日志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../voxel_grid/">体素网格生成器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../event_sim/">事件相机</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">设计</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../design/">架构</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../code_structure/">代码结构</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adding_new_apis/">添加新的 APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../modify_recording_data/">修改记录数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../coding_guidelines/">编码指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../flight_controller/">飞行控制器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simple_flight/">简单飞行</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hello_drone/">Hello Drone</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">外部飞行控制器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >MavLink 和 PX4</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../px4_setup/">AirSim 的 PX4 设置</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_sitl/">软件在环中的 PX4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_sitl_wsl2/">带有 WSL 2 的 PX4 SITL</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_lockstep/">PX4 Lockstep</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_multi_vehicle/">软件在环中的 PX4 多车辆</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://youtu.be/1oY8Qu5maQQ">AirSim 与 Pixhawk</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://youtu.be/HNWdYrtw3f0">使用 AirSim 设置 PX4</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://www.youtube.com/watch?v=d_FyjKDWQfc&feature=youtu.be">调试姿态估计</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://github.com/Microsoft/AirSim/wiki/Intercepting-MavLink-messages">拦截 MavLink 消息</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://github.com/Microsoft/AirSim/wiki/Rapid-Descent-on-PX4-drones">PX4 无人机快速下降</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_build/">构建 PX4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_logging/">PX4/MavLink 日志记录</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../log_viewer/">MavLink 日志查看器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mavlinkcom/">MavLinkCom</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mavlinkcom_mocap/">MavLink MoCap</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >ArduPilot</a>
    <ul>
                <li class="toctree-l2"><a class="" href="https://ardupilot.org/dev/docs/building-the-code.html">ArduPilot 软件在环设置</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://ardupilot.org/dev/docs/sitl-with-airsim.html">AirSim & ArduPilot</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">升级</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_upgrade/">升级虚幻引擎</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrade_apis/">升级 APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrade_settings/">升级设置</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献教程</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../reinforcement_learning/">强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://www.youtube.com/watch?v=y09VbdQWvQY">使用 Marketplace 中的环境</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/simondlevy/AirSimTensorFlow">简单的防撞</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://aka.ms/AutonomousDrivingCookbook">Azure 上的自动驾驶</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/hexacopter">构造六旋翼飞行器</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo">移动路径演示</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../point_clouds/">构建点云</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../drone_survey/">使用无人机进行测量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../orbit/">轨道轨迹</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://youtu.be/Bp86WiLUC80">导入自定义多旋翼网格</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../object_detection/">Object Detection</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://youtu.be/ZonkdMcwXH4">带有 MAVROS 和 PX4 的 AirSim</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">杂项</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_drone/">真实无人机上的 AirSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cmake_linux/">在 Linux 上安装 cmake</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hard_drive/">硬盘繁忙时的提示</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pfm/">pfm 格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_proj/">设置虚幻引擎环境</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_blocks/">Blocks 环境</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../who_is_using/">谁在使用 AirSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../working_with_plugin_contents/">使用 UE 插件内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wiki/technion/technion/">大学生方程式赛车以色列理工学院自驾赛</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">支持</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SUPPORT/">支持</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CHANGELOG/">修改记录</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../create_issue/">创建问题</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/">贡献</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">低空模拟器</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">使用 AirSim</li>
      <li class="breadcrumb-item active">ROS: AirSim ROS 包装器</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="airsim_ros_pkgs">airsim_ros_pkgs<a class="headerlink" href="#airsim_ros_pkgs" title="Permanent link">#</a></h1>
<p>AirSim C++客户端库上的ROS封装。</p>
<h2 id="_1">安装<a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>以下步骤适用于Linux。如果在Windows上运行AirSim，则可以使用Windows Subsystem for Linux（WSL）来运行ROS包装，请参阅 <a href="#setting-up-the-build-environment-on-windows10-using-wsl1-or-wsl2">下面</a> 的说明。如果由于某些问题，您无法或不喜欢在主机Linux上安装ROS和相关工具，您也可以使用Docker尝试，请参阅 <a href="#using-docker-for-ros">为 ROS 封装使用 Docker</a> 中的步骤</p>
<ul>
<li>
<p>如果默认GCC版本不是8或更高版本（使用<code>GCC--version</code>检查） </p>
<ul>
<li>使用 gcc &gt;= 8.0.0: <code>sudo apt-get install gcc-8 g++-8</code></li>
<li>使用 <code>gcc-8 --version</code> 验证安装</li>
</ul>
</li>
<li>
<p>Ubuntu 16.04</p>
<ul>
<li>安装 <a href="https://wiki.ros.org/kinetic/Installation/Ubuntu">ROS kinetic</a></li>
<li>安装tf2 sensor 和 mavros 包：<code>sudo apt-get install ros-kinetic-tf2-sensor-msgs ros-kinetic-tf2-geometry-msgs ros-kinetic-mavros*</code></li>
</ul>
</li>
<li>
<p>Ubuntu 18.04</p>
<ul>
<li>安装 <a href="https://wiki.ros.org/melodic/Installation/Ubuntu">ROS melodic</a></li>
<li>安装 tf2 sensor 和 mavros 包: <code>sudo apt-get install ros-melodic-tf2-sensor-msgs ros-melodic-tf2-geometry-msgs ros-melodic-mavros*</code></li>
</ul>
</li>
<li>
<p>Ubuntu 20.04</p>
<ul>
<li>安装 <a href="https://wiki.ros.org/noetic/Installation/Ubuntu">ROS noetic</a></li>
<li>安装 tf2 sensor 和 mavros 包: <code>sudo apt-get install ros-noetic-tf2-sensor-msgs ros-noetic-tf2-geometry-msgs ros-noetic-mavros*</code></li>
</ul>
</li>
<li>
<p>安装 <a href="https://catkin-tools.readthedocs.io/en/latest/installing.html">catkin_tools</a>
    <code>sudo apt-get install python-catkin-tools</code> 或
    <code>pip install catkin_tools</code>。 如果在 Ubuntu 20.04 则使用 <code>pip install "git+https://github.com/catkin/catkin_tools.git#egg=catkin_tools"</code></p>
</li>
</ul>
<h2 id="_2">构建<a class="headerlink" href="#_2" title="Permanent link">#</a></h2>
<ul>
<li>构建 AirSim</li>
</ul>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/Microsoft/AirSim.git<span class="p">;</span>
<span class="nb">cd</span><span class="w"> </span>AirSim<span class="p">;</span>
./setup.sh<span class="p">;</span>
./build.sh<span class="p">;</span>
</code></pre></div>
<ul>
<li>确保已按照上面的安装页面中所述设置ROS的环境变量。为方便起见，将<code>source</code>命令添加到<code>.bashrc</code>中（用特定的版本名替换<code>mediatic</code>）：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;source /opt/ros/melodic/setup.bash&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</code></pre></div>
<ul>
<li>构建 ROS 包</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ros<span class="p">;</span>
catkin<span class="w"> </span>build<span class="p">;</span><span class="w"> </span><span class="c1"># 或 catkin_make</span>
</code></pre></div>
<p>如果默认GCC不是8或更高（使用<code>GCC--version</code>检查），则编译将失败。在这种情况下，请显式使用<code>gcc-8</code>，如下所示</p>
<div class="highlight"><pre><span></span><code>catkin<span class="w"> </span>build<span class="w"> </span>-DCMAKE_C_COMPILER<span class="o">=</span>gcc-8<span class="w"> </span>-DCMAKE_CXX_COMPILER<span class="o">=</span>g++-8
</code></pre></div>
<h2 id="_3">运行<a class="headerlink" href="#_3" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>devel/setup.bash<span class="p">;</span>
roslaunch<span class="w"> </span>airsim_ros_pkgs<span class="w"> </span>airsim_node.launch<span class="p">;</span>
roslaunch<span class="w"> </span>airsim_ros_pkgs<span class="w"> </span>rviz.launch<span class="p">;</span>
</code></pre></div>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>如果在运行<code>roslaunch airsim_ros_pkgs airsim_node.launch</code>时出错，请运行<code>catkin clean</code>，然后重试</p>
</div>
<h2 id="airsim-ros">使用 AirSim ROS 包装器<a class="headerlink" href="#airsim-ros" title="Permanent link">#</a></h2>
<p>ROS包装器由两个ROS节点组成——第一个是AirSim多旋翼 C++ 客户端库的包装器，第二个是简单的 比例-微分(PD) 位置控制器。
让我们看看这 2 个节点的ROS API：</p>
<h3 id="airsim-ros_1">AirSim ROS 包装器节点<a class="headerlink" href="#airsim-ros_1" title="Permanent link">#</a></h3>
<h4 id="_4">发布者：<a class="headerlink" href="#_4" title="Permanent link">#</a></h4>
<ul>
<li>
<p><code>/airsim_node/origin_geo_point</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/GPSYaw.msg">airsim_ros_pkgs/GPSYaw</a>
GPS coordinates corresponding to global NED frame. This is set in the airsim's <a href="https://microsoft.github.io/AirSim/settings/">settings.json</a> file under the <code>OriginGeopoint</code> key.</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/global_gps</code> <a href="https://docs.ros.org/api/sensor_msgs/html/msg/NavSatFix.html">sensor_msgs/NavSatFix</a>
This the current GPS coordinates of the drone in airsim.</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/odom_local_ned</code> <a href="https://docs.ros.org/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a>
Odometry in NED frame (default name: odom_local_ned, launch name and frame type are configurable) wrt take-off point.</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/CAMERA_NAME/IMAGE_TYPE/camera_info</code> <a href="https://docs.ros.org/api/sensor_msgs/html/msg/CameraInfo.html">sensor_msgs/CameraInfo</a></p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/CAMERA_NAME/IMAGE_TYPE</code> <a href="https://docs.ros.org/api/sensor_msgs/html/msg/Image.html">sensor_msgs/Image</a>
  RGB or float image depending on image type requested in settings.json.</p>
</li>
<li>
<p><code>/tf</code> <a href="https://docs.ros.org/api/tf2_msgs/html/msg/TFMessage.html">tf2_msgs/TFMessage</a></p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/altimeter/SENSOR_NAME</code> <a href="https://github.com/microsoft/AirSim/blob/main/ros/src/airsim_ros_pkgs/msg/Altimeter.msg">airsim_ros_pkgs/Altimeter</a>
This the current altimeter reading for altitude, pressure, and <a href="https://en.wikipedia.org/wiki/QNH">QNH</a></p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/imu/SENSOR_NAME</code> <a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs::Imu</a>
IMU sensor data</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/magnetometer/SENSOR_NAME</code> <a href="http://docs.ros.org/api/sensor_msgs/html/msg/MagneticField.html">sensor_msgs::MagneticField</a>
  Meausrement of magnetic field vector/compass</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/distance/SENSOR_NAME</code> <a href="http://docs.ros.org/api/sensor_msgs/html/msg/Range.html">sensor_msgs::Range</a>
  Meausrement of distance from an active ranger, such as infrared or IR</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/lidar/SENSOR_NAME</code> <a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs::PointCloud2</a>
  LIDAR pointcloud</p>
</li>
</ul>
<h4 id="_5">订阅者:<a class="headerlink" href="#_5" title="Permanent link">#</a></h4>
<ul>
<li>
<p><code>/airsim_node/vel_cmd_body_frame</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/VelCmd.msg">airsim_ros_pkgs/VelCmd</a>
  Ignore <code>vehicle_name</code> field, leave it to blank. We will use <code>vehicle_name</code> in future for multiple drones.</p>
</li>
<li>
<p><code>/airsim_node/vel_cmd_world_frame</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/VelCmd.msg">airsim_ros_pkgs/VelCmd</a>
  Ignore <code>vehicle_name</code> field, leave it to blank. We will use <code>vehicle_name</code> in future for multiple drones.</p>
</li>
<li>
<p><code>/gimbal_angle_euler_cmd</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/GimbalAngleEulerCmd.msg">airsim_ros_pkgs/GimbalAngleEulerCmd</a>
  Gimbal set point in euler angles.</p>
</li>
<li>
<p><code>/gimbal_angle_quat_cmd</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/GimbalAngleQuatCmd.msg">airsim_ros_pkgs/GimbalAngleQuatCmd</a>
  Gimbal set point in quaternion.</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/car_cmd</code> <a href="https://github.com/microsoft/AirSim/blob/main/ros/src/airsim_ros_pkgs/msg/CarControls.msg">airsim_ros_pkgs/CarControls</a>
Throttle, brake, steering and gear selections for control. Both automatic and manual transmission control possible, see the <a href="https://github.com/microsoft/AirSim/blob/main/ros/src/airsim_ros_pkgs/scripts/car_joy"><code>car_joy.py</code></a> script for use.</p>
</li>
</ul>
<h4 id="_6">服务:<a class="headerlink" href="#_6" title="Permanent link">#</a></h4>
<ul>
<li>
<p><code>/airsim_node/VEHICLE_NAME/land</code> <a href="https://docs.ros.org/api/std_srvs/html/srv/Empty.html">airsim_ros_pkgs/Takeoff</a></p>
</li>
<li>
<p><code>/airsim_node/takeoff</code> <a href="https://docs.ros.org/api/std_srvs/html/srv/Empty.html">airsim_ros_pkgs/Takeoff</a></p>
</li>
<li>
<p><code>/airsim_node/reset</code> <a href="https://docs.ros.org/api/std_srvs/html/srv/Empty.html">airsim_ros_pkgs/Reset</a>
 Resets <em>all</em> drones</p>
</li>
</ul>
<h4 id="_7">参数:<a class="headerlink" href="#_7" title="Permanent link">#</a></h4>
<ul>
<li>
<p><code>/airsim_node/world_frame_id</code> [string]
  Set in: <code>$(airsim_ros_pkgs)/launch/airsim_node.launch</code>
  Default: world_ned
  Set to "world_enu" to switch to ENU frames automatically</p>
</li>
<li>
<p><code>/airsim_node/odom_frame_id</code> [string]
  Set in: <code>$(airsim_ros_pkgs)/launch/airsim_node.launch</code>
  Default: odom_local_ned
  If you set world_frame_id to "world_enu", the default odom name will instead default to "odom_local_enu"</p>
</li>
<li>
<p><code>/airsim_node/coordinate_system_enu</code> [boolean]
  Set in: <code>$(airsim_ros_pkgs)/launch/airsim_node.launch</code>
  Default: false
  If you set world_frame_id to "world_enu", this setting will instead default to true</p>
</li>
<li>
<p><code>/airsim_node/update_airsim_control_every_n_sec</code> [double]
  Set in: <code>$(airsim_ros_pkgs)/launch/airsim_node.launch</code>
  Default: 0.01 seconds.
  Timer callback frequency for updating drone odom and state from airsim, and sending in control commands.
  The current RPClib interface to unreal engine maxes out at 50 Hz.
  Timer callbacks in ROS run at maximum rate possible, so it's best to not touch this parameter.</p>
</li>
<li>
<p><code>/airsim_node/update_airsim_img_response_every_n_sec</code> [double]
  Set in: <code>$(airsim_ros_pkgs)/launch/airsim_node.launch</code>
  Default: 0.01 seconds.
  Timer callback frequency for receiving images from all cameras in airsim.
  The speed will depend on number of images requested and their resolution.
  Timer callbacks in ROS run at maximum rate possible, so it's best to not touch this parameter.</p>
</li>
<li>
<p><code>/airsim_node/publish_clock</code> [double]
  Set in: <code>$(airsim_ros_pkgs)/launch/airsim_node.launch</code>
  Default: false
  Will publish the ros /clock topic if set to true.</p>
</li>
</ul>
<h3 id="pid">简单 PID 位置控制器节点<a class="headerlink" href="#pid" title="Permanent link">#</a></h3>
<h4 id="_8">参数:<a class="headerlink" href="#_8" title="Permanent link">#</a></h4>
<ul>
<li>PD 控制器参数：</li>
<li>
<p><code>/pd_position_node/kd_x</code> [double],
    <code>/pd_position_node/kp_y</code> [double],
    <code>/pd_position_node/kp_z</code> [double],
    <code>/pd_position_node/kp_yaw</code> [double]
    Proportional gains</p>
</li>
<li>
<p><code>/pd_position_node/kd_x</code> [double],
    <code>/pd_position_node/kd_y</code> [double],
    <code>/pd_position_node/kd_z</code> [double],
    <code>/pd_position_node/kd_yaw</code> [double]
    Derivative gains</p>
</li>
<li>
<p><code>/pd_position_node/reached_thresh_xyz</code> [double]
    Threshold euler distance (meters) from current position to setpoint position</p>
</li>
<li>
<p><code>/pd_position_node/reached_yaw_degrees</code> [double]
    Threshold yaw distance (degrees) from current position to setpoint position</p>
</li>
<li>
<p><code>/pd_position_node/update_control_every_n_sec</code> [double]
  Default: 0.01 seconds</p>
</li>
</ul>
<h4 id="_9">服务:<a class="headerlink" href="#_9" title="Permanent link">#</a></h4>
<ul>
<li>
<p><code>/airsim_node/VEHICLE_NAME/gps_goal</code> [Request: <a href="https://github.com/microsoft/AirSim/blob/main/ros/src/airsim_ros_pkgs/srv/SetGPSPosition.srv">srv/SetGPSPosition</a>]
  Target gps position + yaw.
  In <strong>absolute</strong> altitude.</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/local_position_goal</code> [Request: <a href="https://github.com/microsoft/AirSim/blob/main/ros/src/airsim_ros_pkgs/srv/SetLocalPosition.srv">srv/SetLocalPosition</a>]
  Target local position + yaw in global NED frame.</p>
</li>
</ul>
<h4 id="_10">订阅者:<a class="headerlink" href="#_10" title="Permanent link">#</a></h4>
<ul>
<li>
<p><code>/airsim_node/origin_geo_point</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/GPSYaw.msg">airsim_ros_pkgs/GPSYaw</a>
  Listens to home geo coordinates published by <code>airsim_node</code>.</p>
</li>
<li>
<p><code>/airsim_node/VEHICLE_NAME/odom_local_ned</code> <a href="https://docs.ros.org/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a>
  Listens to odometry published by <code>airsim_node</code></p>
</li>
</ul>
<h4 id="_11">发布者:<a class="headerlink" href="#_11" title="Permanent link">#</a></h4>
<ul>
<li><code>/vel_cmd_world_frame</code> <a href="https://github.com/microsoft/AirSim/tree/main/ros/src/airsim_ros_pkgs/msg/VelCmd.msg">airsim_ros_pkgs/VelCmd</a>
  Sends velocity command to <code>airsim_node</code></li>
</ul>
<h4 id="_12">全局参数<a class="headerlink" href="#_12" title="Permanent link">#</a></h4>
<ul>
<li>
<p>Dynamic constraints. These can be changed in <code>dynamic_constraints.launch</code>:</p>
<ul>
<li>
<p><code>/max_vel_horz_abs</code> [double]
  Maximum horizontal velocity of the drone (meters/second)</p>
</li>
<li>
<p><code>/max_vel_vert_abs</code> [double]
  Maximum vertical velocity of the drone (meters/second)</p>
</li>
<li>
<p><code>/max_yaw_rate_degree</code> [double]
  Maximum yaw rate (degrees/second)</p>
</li>
</ul>
</li>
</ul>
<h2 id="_13">杂项<a class="headerlink" href="#_13" title="Permanent link">#</a></h2>
<h3 id="wsl1-wsl2-windows10">使用 WSL1 或 WSL2 在 Windows10 上设置构架环境<a class="headerlink" href="#wsl1-wsl2-windows10" title="Permanent link">#</a></h3>
<p>这些安装说明描述了如何设置“Windows上Ubuntu上的Bash”（又名“Linux的Windows子系统”）。</p>
<p>它涉及在Windows10中启用内置的Windows Linux环境（WSL），安装兼容的Linux OS映像，最后安装构建环境，就像它是一个普通的Linux系统一样。</p>
<p>完成后，您将能够像在本机linux机器中一样构建和运行ros包装器。</p>
<h5 id="wsl1-vs-wsl2">WSL1 vs WSL2<a class="headerlink" href="#wsl1-vs-wsl2" title="Permanent link">#</a></h5>
<p>WSL2 is the latest version of the Windows10 Subsystem for Linux. It is many times faster than WSL1 (if you use the native file system in <code>/home/...</code> rather
than Windows mounted folders under <code>/mnt/...</code>) and is therefore much preferred for building the code in terms of speed.</p>
<p>Once installed, you can switch between WSL1 or WSL2 versions as you prefer.</p>
<h5 id="wsl-setup-steps">WSL Setup steps<a class="headerlink" href="#wsl-setup-steps" title="Permanent link">#</a></h5>
<ol>
<li>
<p>Follow the instructions <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">here</a>. Check that the ROS version you want to use is supported by the Ubuntu version you want to install.</p>
</li>
<li>
<p>Congratulations, you now have a working Ubuntu subsystem under Windows, you can now go to <a href="#setup">Ubuntu 16 / 18 instructions</a> and then <a href="#how-to-run-airsim-on-windows-and-ros-wrapper-on-wsl">How to run Airsim on Windows and ROS wrapper on WSL</a>!</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can run XWindows applications (including SITL) by installing <a href="https://sourceforge.net/projects/vcxsrv/">VcXsrv</a>  on Windows.
To use it find and run <code>XLaunch</code> from the Windows start menu.
Select <code>Multiple Windows</code> in first popup, <code>Start no client</code> in second popup, <strong>only</strong> <code>Clipboard</code> in third popup. Do <strong>not</strong> select <code>Native Opengl</code> (and if you are not able to connect select <code>Disable access control</code>).
You will need to set the DISPLAY variable to point to your display: in WSL it is <code>127.0.0.1:0</code>, in WSL2 it will be the ip address of the PC's network port and can be set by using the code below. Also in WSL2 you may have to disable the firewall for public networks, or create an exception in order for VcXsrv to communicate with WSL2:</p>
<p><code>export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}'):0</code></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>If you add this line to your ~/.bashrc file you won't need to run this command again</li>
<li>For code editing you can install VSCode inside WSL.</li>
<li>Windows 10 includes "Windows Defender" virus scanner. It will slow down WSL quite a bit. Disabling it greatly improves disk performance but increases your risk to viruses so disable at your own risk. Here is one of many resources/videos that show you how to disable it: <a href="https://youtu.be/FmjblGay3AM">How to Disable or Enable Windows Defender on Windows 10</a></li>
</ul>
</div>
<h5 id="file-system-access-between-wsl-and-windows10">File System Access between WSL and Windows10<a class="headerlink" href="#file-system-access-between-wsl-and-windows10" title="Permanent link">#</a></h5>
<p>From within WSL, the Windows drives are referenced in the /mnt directory. For example, in order to list documents within your (<username>) documents folder:</p>
<pre><code>`ls /mnt/c/'Documents and Settings'/&lt;username&gt;/Documents`
or
`ls /mnt/c/Users/&lt;username&gt;/Documents`
</code></pre>
<p>From within Windows, the WSL distribution's files are located at (type in windows Explorer address bar):</p>
<p><code>\\wsl$\&lt;distribution name&gt;</code>
   e.g.
   <code>\\wsl$\Ubuntu-18.04</code></p>
<h5 id="how-to-run-airsim-on-windows-and-ros-wrapper-on-wsl">How to run Airsim on Windows and ROS wrapper on WSL<a class="headerlink" href="#how-to-run-airsim-on-windows-and-ros-wrapper-on-wsl" title="Permanent link">#</a></h5>
<p>For WSL 1 execute:
<code>export WSL_HOST_IP=127.0.0.1</code>
and for WSL 2:
<code>export WSL_HOST_IP=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')</code>
Now, as in the <a href="#running">running section for linux</a>, execute the following:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>devel/setup.bash
roslaunch<span class="w"> </span>airsim_ros_pkgs<span class="w"> </span>airsim_node.launch<span class="w"> </span>output:<span class="o">=</span>screen<span class="w"> </span>host:<span class="o">=</span><span class="nv">$WSL_HOST_IP</span>
roslaunch<span class="w"> </span>airsim_ros_pkgs<span class="w"> </span>rviz.launch
</code></pre></div>
<h3 id="using-docker-for-ros">Using Docker for ROS<a class="headerlink" href="#using-docker-for-ros" title="Permanent link">#</a></h3>
<p>A Dockerfile is present in the <a href="https://github.com/microsoft/AirSim/tree/main/tools/Dockerfile-ROS"><code>tools</code></a> directory. To build the <code>airsim-ros</code> image -</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>tools
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>airsim-ros<span class="w"> </span>-f<span class="w"> </span>Dockerfile-ROS<span class="w"> </span>.
</code></pre></div>
<p>To run, replace the path of the AirSim folder below -</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>--net<span class="o">=</span>host<span class="w"> </span>-v<span class="w"> </span>&lt;your-AirSim-folder-path&gt;:/home/testuser/AirSim<span class="w"> </span>airsim-ros:latest<span class="w"> </span>bash
</code></pre></div>
<p>The above command mounts the AirSim directory to the home directory inside the container. Any changes you make in the source files from your host will be visible inside the container, which is useful for development and testing. Now follow the steps from <a href="#build">Build</a> to compile and run the ROS wrapper.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../InfraredCamera/" class="btn btn-neutral float-left" title="红外相机"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../airsim_tutorial_pkgs/" class="btn btn-neutral float-right" title="ROS: AirSim 教程包">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>OpenHUTB 版权所有 &copy; 2025</p>
  </div>

</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../InfraredCamera/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../airsim_tutorial_pkgs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
