<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>图像 APIs - 低空模拟器</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u56fe\u50cf APIs";
        var mkdocs_page_input_path = "image_apis.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 低空模拟器
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">主页</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 AirSim</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../use_precompiled/">下载二进制文件</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">在 Windows 上构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">在 Linux 上构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_macos/">在 macOS 上构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../docker_ubuntu/">Linux 上的 Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../azure/">Azure 上的 ArSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_custenv/">定制虚幻引擎环境</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">场景问题和回答</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">使用 AirSim</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../apis/">核心 APIs</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">图像 APIs</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#getting-a-single-image">Getting a Single Image</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#python">Python</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#c">C++</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#getting-images-with-more-flexibility">Getting Images with More Flexibility</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#python_1">Python</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#using-airsim-images-with-numpy">Using AirSim Images with NumPy</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#quick-tips">Quick Tips</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#c_1">C++</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ready-to-run-complete-examples">Ready to Run Complete Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#python_2">Python</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#c_2">C++</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#available-cameras">Available Cameras</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#car">Car</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#multirotor">Multirotor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#computer-vision-mode">Computer Vision Mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#backward-compatibility-for-camera-names">Backward compatibility for camera names</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_1">"计算机视觉" 模式</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#setting-pose-in-computer-vision-mode">Setting Pose in Computer Vision Mode</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#camera-apis">Camera APIs</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#gimbal">Gimbal</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#changing-resolution-and-camera-parameters">Changing Resolution and Camera Parameters</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#what-does-pixel-values-mean-in-different-image-types">What Does Pixel Values Mean in Different Image Types?</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#available-imagetype-values">Available ImageType Values</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#depthplanar-and-depthperspective">DepthPlanar and DepthPerspective</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#depthvis">DepthVis</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#disparitynormalized">DisparityNormalized</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#segmentation">Segmentation</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#unsetting-object-id">Unsetting object ID</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#how-to-find-mesh-names">How to Find Mesh Names?</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#changing-colors-for-object-ids">Changing Colors for Object IDs</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#startup-object-ids">Startup Object IDs</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#getting-object-id-for-mesh">Getting Object ID for Mesh</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#infrared">Infrared</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#opticalflow-and-opticalflowvis">OpticalFlow and OpticalFlowVis</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-code">Example Code</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../apis_cpp/">C++ APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../api_docs/html/index.html">API 参考文档</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wiki/">Wiki 文档</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev_workflow/">开发工作流</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../settings/">设置</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../map/">地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../camera_views/">相机视角</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../using_car/">汽车模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../remote_control/">远程控制</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../xbox_controller/">XBox 控制器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../steering_wheel_installation/">方向盘</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multi_vehicle/">多车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >传感器</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../sensors/">传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../lidar/">激光雷达</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../distance_sensor/">距离传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../InfraredCamera/">红外相机</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../airsim_ros_pkgs/">ROS: AirSim ROS 包装器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../airsim_tutorial_pkgs/">ROS: AirSim 教程包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gazebo_drone/">导入 Gazebo 模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../retexturing/">域随机化</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../meshes/">网格顶点缓冲区</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../playback/">播放日志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../voxel_grid/">体素网格生成器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../event_sim/">事件相机</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">设计</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../design/">架构</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../code_structure/">代码结构</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adding_new_apis/">添加新的 APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../modify_recording_data/">修改记录数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../coding_guidelines/">编码指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../flight_controller/">飞行控制器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simple_flight/">简单飞行</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hello_drone/">Hello Drone</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">外部飞行控制器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >MavLink 和 PX4</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../px4_setup/">AirSim 的 PX4 设置</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_sitl/">软件在环中的 PX4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_sitl_wsl2/">带有 WSL 2 的 PX4 SITL</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_lockstep/">PX4 Lockstep</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_multi_vehicle/">软件在环中的 PX4 多车辆</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://youtu.be/1oY8Qu5maQQ">AirSim 与 Pixhawk</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://youtu.be/HNWdYrtw3f0">使用 AirSim 设置 PX4</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://www.youtube.com/watch?v=d_FyjKDWQfc&feature=youtu.be">调试姿态估计</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://github.com/Microsoft/AirSim/wiki/Intercepting-MavLink-messages">拦截 MavLink 消息</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://github.com/Microsoft/AirSim/wiki/Rapid-Descent-on-PX4-drones">PX4 无人机快速下降</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_build/">构建 PX4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../px4_logging/">PX4/MavLink 日志记录</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../log_viewer/">MavLink 日志查看器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mavlinkcom/">MavLinkCom</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mavlinkcom_mocap/">MavLink MoCap</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >ArduPilot</a>
    <ul>
                <li class="toctree-l2"><a class="" href="https://ardupilot.org/dev/docs/building-the-code.html">ArduPilot 软件在环设置</a>
                </li>
                <li class="toctree-l2"><a class="" href="https://ardupilot.org/dev/docs/sitl-with-airsim.html">AirSim & ArduPilot</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">升级</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_upgrade/">升级虚幻引擎</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrade_apis/">升级 APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../upgrade_settings/">升级设置</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献教程</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../reinforcement_learning/">强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://www.youtube.com/watch?v=y09VbdQWvQY">使用 Marketplace 中的环境</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/simondlevy/AirSimTensorFlow">简单的防撞</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://aka.ms/AutonomousDrivingCookbook">Azure 上的自动驾驶</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/hexacopter">构造六旋翼飞行器</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo">移动路径演示</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../point_clouds/">构建点云</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../drone_survey/">使用无人机进行测量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../orbit/">轨道轨迹</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://youtu.be/Bp86WiLUC80">导入自定义多旋翼网格</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../object_detection/">Object Detection</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://youtu.be/ZonkdMcwXH4">带有 MAVROS 和 PX4 的 AirSim</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">杂项</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_drone/">真实无人机上的 AirSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cmake_linux/">在 Linux 上安装 cmake</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hard_drive/">硬盘繁忙时的提示</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pfm/">pfm 格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_proj/">设置虚幻引擎环境</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../unreal_blocks/">Blocks 环境</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../who_is_using/">谁在使用 AirSim</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../working_with_plugin_contents/">使用 UE 插件内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wiki/technion/technion/">大学生方程式赛车以色列理工学院自驾赛</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">支持</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SUPPORT/">支持</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CHANGELOG/">修改记录</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../create_issue/">创建问题</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/">贡献</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">低空模拟器</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">使用 AirSim</li>
      <li class="breadcrumb-item active">图像 APIs</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="image-apis">Image APIs<a class="headerlink" href="#image-apis" title="Permanent link">#</a></h1>
<p>Please read <a href="../apis/">general API doc</a> first if you are not familiar with AirSim APIs.</p>
<h2 id="getting-a-single-image">Getting a Single Image<a class="headerlink" href="#getting-a-single-image" title="Permanent link">#</a></h2>
<p>Here's a sample code to get a single image from camera named "0". The returned value is bytes of png format image. To get uncompressed and other format as well as available cameras please see next sections.</p>
<h3 id="python">Python<a class="headerlink" href="#python" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">airsim</span> <span class="c1">#pip install airsim</span>

<span class="c1"># for car use CarClient() </span>
<span class="n">client</span> <span class="o">=</span> <span class="n">airsim</span><span class="o">.</span><span class="n">MultirotorClient</span><span class="p">()</span>

<span class="n">png_image</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simGetImage</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">airsim</span><span class="o">.</span><span class="n">ImageType</span><span class="o">.</span><span class="n">Scene</span><span class="p">)</span>
<span class="c1"># do something with image</span>
</code></pre></div>
<h3 id="c">C++<a class="headerlink" href="#c" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;vehicles/multirotor/api/MultirotorRpcLibClient.hpp&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">getOneImage</span><span class="p">()</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">msr</span><span class="o">::</span><span class="nn">airlib</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// for car use CarRpcLibClient</span>
<span class="w">    </span><span class="n">MultirotorRpcLibClient</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">png_image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">simGetImage</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">VehicleCameraBase</span><span class="o">::</span><span class="n">ImageType</span><span class="o">::</span><span class="n">Scene</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// do something with images</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="getting-images-with-more-flexibility">Getting Images with More Flexibility<a class="headerlink" href="#getting-images-with-more-flexibility" title="Permanent link">#</a></h2>
<p>The <code>simGetImages</code> API which is slightly more complex to use than <code>simGetImage</code> API, for example, you can get left camera view, right camera view and depth image from left camera in a single API call. The <code>simGetImages</code> API also allows you to get uncompressed images as well as floating point single channel images (instead of 3 channel (RGB), each 8 bit).</p>
<h3 id="python_1">Python<a class="headerlink" href="#python_1" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">airsim</span> <span class="c1">#pip install airsim</span>

<span class="c1"># for car use CarClient() </span>
<span class="n">client</span> <span class="o">=</span> <span class="n">airsim</span><span class="o">.</span><span class="n">MultirotorClient</span><span class="p">()</span>

<span class="n">responses</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simGetImages</span><span class="p">([</span>
    <span class="c1"># png format</span>
    <span class="n">airsim</span><span class="o">.</span><span class="n">ImageRequest</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">airsim</span><span class="o">.</span><span class="n">ImageType</span><span class="o">.</span><span class="n">Scene</span><span class="p">),</span> 
    <span class="c1"># uncompressed RGB array bytes</span>
    <span class="n">airsim</span><span class="o">.</span><span class="n">ImageRequest</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">airsim</span><span class="o">.</span><span class="n">ImageType</span><span class="o">.</span><span class="n">Scene</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="c1"># floating point uncompressed image</span>
    <span class="n">airsim</span><span class="o">.</span><span class="n">ImageRequest</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">airsim</span><span class="o">.</span><span class="n">ImageType</span><span class="o">.</span><span class="n">DepthPlanar</span><span class="p">,</span> <span class="kc">True</span><span class="p">)])</span>

 <span class="c1"># do something with response which contains image data, pose, timestamp etc</span>
</code></pre></div>
<h4 id="using-airsim-images-with-numpy">Using AirSim Images with NumPy<a class="headerlink" href="#using-airsim-images-with-numpy" title="Permanent link">#</a></h4>
<p>If you plan to use numpy for image manipulation, you should get uncompressed RGB image and then convert to numpy like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">responses</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simGetImages</span><span class="p">([</span><span class="n">airsim</span><span class="o">.</span><span class="n">ImageRequest</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">airsim</span><span class="o">.</span><span class="n">ImageType</span><span class="o">.</span><span class="n">Scene</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)])</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">responses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># get numpy array</span>
<span class="n">img1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">image_data_uint8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> 

<span class="c1"># reshape array to 4 channel image array H X W X 4</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">img1d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># original image is fliped vertically</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">)</span>

<span class="c1"># write to png </span>
<span class="n">airsim</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">),</span> <span class="n">img_rgb</span><span class="p">)</span> 
</code></pre></div>
<h4 id="quick-tips">Quick Tips<a class="headerlink" href="#quick-tips" title="Permanent link">#</a></h4>
<ul>
<li>
<p>The API <code>simGetImage</code> returns <code>binary string literal</code> which means you can simply dump it in binary file to create a .png file. However if you want to process it in any other way than you can handy function <code>airsim.string_to_uint8_array</code>. This converts binary string literal to NumPy uint8 array.</p>
</li>
<li>
<p>The API <code>simGetImages</code> can accept request for multiple image types from any cameras in single call. You can specify if image is png compressed, RGB uncompressed or float array. For png compressed images, you get <code>binary string literal</code>. For float array you get Python list of float64. You can convert this float array to NumPy 2D array using
    <div class="highlight"><pre><span></span><code>airsim.list_to_2d_float_array(response.image_data_float, response.width, response.height)
</code></pre></div>
    You can also save float array to .pfm file (Portable Float Map format) using <code>airsim.write_pfm()</code> function.</p>
</li>
<li>
<p>If you are looking to query position and orientation information in sync with a call to one of the image APIs, you can use <code>client.simPause(True)</code> and <code>client.simPause(False)</code> to pause the simulation while calling the image API and querying the desired physics state, ensuring that the physics state remains the same immediately after the image API call.</p>
</li>
</ul>
<h3 id="c_1">C++<a class="headerlink" href="#c_1" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">getStereoAndDepthImages</span><span class="p">()</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">msr</span><span class="o">::</span><span class="nn">airlib</span><span class="p">;</span>

<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="n">VehicleCameraBase</span><span class="o">::</span><span class="n">ImageRequest</span><span class="w"> </span><span class="n">ImageRequest</span><span class="p">;</span>
<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="n">VehicleCameraBase</span><span class="o">::</span><span class="n">ImageResponse</span><span class="w"> </span><span class="n">ImageResponse</span><span class="p">;</span>
<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="n">VehicleCameraBase</span><span class="o">::</span><span class="n">ImageType</span><span class="w"> </span><span class="n">ImageType</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// for car use</span>
<span class="w">    </span><span class="c1">// CarRpcLibClient client;</span>
<span class="w">    </span><span class="n">MultirotorRpcLibClient</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// get right, left and depth images. First two as png, second as float16.</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ImageRequest</span><span class="o">&gt;</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="c1">//png format</span>
<span class="w">        </span><span class="n">ImageRequest</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageType</span><span class="o">::</span><span class="n">Scene</span><span class="p">),</span>
<span class="w">        </span><span class="c1">//uncompressed RGB array bytes</span>
<span class="w">        </span><span class="n">ImageRequest</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageType</span><span class="o">::</span><span class="n">Scene</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">),</span><span class="w">       </span>
<span class="w">        </span><span class="c1">//floating point uncompressed image  </span>
<span class="w">        </span><span class="n">ImageRequest</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageType</span><span class="o">::</span><span class="n">DepthPlanar</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ImageResponse</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">simGetImages</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// do something with response which contains image data, pose, timestamp etc</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="ready-to-run-complete-examples">Ready to Run Complete Examples<a class="headerlink" href="#ready-to-run-complete-examples" title="Permanent link">#</a></h2>
<h3 id="python_2">Python<a class="headerlink" href="#python_2" title="Permanent link">#</a></h3>
<p>For a more complete ready to run sample code please see <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//multirotor/hello_drone.py">sample code in AirSimClient project</a> for multirotors or <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//car/hello_car.py">HelloCar sample</a>. This code also demonstrates simple activities such as saving images in files or using <code>numpy</code> to manipulate images.</p>
<h3 id="c_2">C++<a class="headerlink" href="#c_2" title="Permanent link">#</a></h3>
<p>For a more complete ready to run sample code please see <a href="https://github.com/Microsoft/AirSim/tree/main/HelloDrone//main.cpp">sample code in HelloDrone project</a> for multirotors or <a href="https://github.com/Microsoft/AirSim/tree/main/HelloCar//main.cpp">HelloCar project</a>. </p>
<p>See also <a href="https://github.com/Microsoft/AirSim/tree/main/Examples/DataCollection/StereoImageGenerator.hpp">other example code</a> that generates specified number of stereo images along with ground truth depth and disparity and saving it to <a href="../pfm/">pfm format</a>.</p>
<h2 id="available-cameras">Available Cameras<a class="headerlink" href="#available-cameras" title="Permanent link">#</a></h2>
<p>These are the default cameras already available in each vehicle. Apart from these, you can add more cameras to the vehicles and external cameras which are not attached to any vehicle through the <a href="../settings/">settings</a>.</p>
<h3 id="car">Car<a class="headerlink" href="#car" title="Permanent link">#</a></h3>
<p>The cameras on car can be accessed by following names in API calls: <code>front_center</code>, <code>front_right</code>, <code>front_left</code>, <code>fpv</code> and <code>back_center</code>. Here FPV camera is driver's head position in the car.</p>
<h3 id="multirotor">Multirotor<a class="headerlink" href="#multirotor" title="Permanent link">#</a></h3>
<p>The cameras on the drone can be accessed by following names in API calls: <code>front_center</code>, <code>front_right</code>, <code>front_left</code>, <code>bottom_center</code> and <code>back_center</code>. </p>
<h3 id="computer-vision-mode">Computer Vision Mode<a class="headerlink" href="#computer-vision-mode" title="Permanent link">#</a></h3>
<p>Camera names are same as in multirotor.</p>
<h3 id="backward-compatibility-for-camera-names">Backward compatibility for camera names<a class="headerlink" href="#backward-compatibility-for-camera-names" title="Permanent link">#</a></h3>
<p>Before AirSim v1.2, cameras were accessed using ID numbers instead of names. For backward compatibility you can still use following ID numbers for above camera names in same order as above: <code>"0"</code>, <code>"1"</code>, <code>"2"</code>, <code>"3"</code>, <code>"4"</code>. In addition, camera name <code>""</code> is also available to access the default camera which is generally the camera <code>"0"</code>.</p>
<h2 id="_1">"计算机视觉" 模式<a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>您可以在所谓的“计算机视觉”模式下使用 AirSim。在此模式下，物理引擎将被禁用，并且没有飞行器，只有摄像头（如果您想要飞行器但不包含其运动学特性，可以使用多旋翼模式和物理引擎 <a href="../settings/##physicsenginename">ExternalPhysicsEngine</a> ）。您可以使用键盘移动（使用 F1 查看按键帮助）。您可以按下录制按钮来连续生成图像。或者，您可以调用 API 来移动摄像头并拍摄图像。</p>
<p>要激活此模式，请编辑您可以在 Documents\AirSim 文件夹（或 Linux 上的 ~/Documents/AirSim）中找到的 <a href="../settings/">settings.json</a>，并确保根级别存在以下值：</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;SettingsVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;SimMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ComputerVision&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>以下是移动摄像头并拍摄图像的 <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//computer_vision/cv_mode.py">Python 代码示例</a> 。</p>
<p>此模式受到 <a href="http://unrealcv.org/">UnrealCV 项目</a> 的启发。</p>
<h3 id="setting-pose-in-computer-vision-mode">Setting Pose in Computer Vision Mode<a class="headerlink" href="#setting-pose-in-computer-vision-mode" title="Permanent link">#</a></h3>
<p>To move around the environment using APIs you can use <code>simSetVehiclePose</code> API. This API takes position and orientation and sets that on the invisible vehicle where the front-center camera is located. All rest of the cameras move along keeping the relative position. If you don't want to change position (or orientation) then just set components of position (or orientation) to floating point nan values. The <code>simGetVehiclePose</code> allows to retrieve the current pose. You can also use <code>simGetGroundTruthKinematics</code> to get the quantities kinematics quantities for the movement. Many other non-vehicle specific APIs are also available such as segmentation APIs, collision APIs and camera APIs.</p>
<h2 id="camera-apis">Camera APIs<a class="headerlink" href="#camera-apis" title="Permanent link">#</a></h2>
<p>The <code>simGetCameraInfo</code> returns the pose (in world frame, NED coordinates, SI units) and FOV (in degrees) for the specified camera. Please see <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//computer_vision/cv_mode.py">example usage</a>.</p>
<p>The <code>simSetCameraPose</code> sets the pose for the specified camera while taking an input pose as a combination of relative position and a quaternion in NED frame. The handy <code>airsim.to_quaternion()</code> function allows to convert pitch, roll, yaw to quaternion. For example, to set camera-0 to 15-degree pitch while maintaining the same position, you can use:
<div class="highlight"><pre><span></span><code>camera_pose = airsim.Pose(airsim.Vector3r(0, 0, 0), airsim.to_quaternion(0.261799, 0, 0))  #PRY in radians
client.simSetCameraPose(0, camera_pose);
</code></pre></div></p>
<ul>
<li><code>simSetCameraFov</code> allows changing the Field-of-View of the camera at runtime.</li>
<li><code>simSetDistortionParams</code>, <code>simGetDistortionParams</code> allow setting and fetching the distortion parameters K1, K2, K3, P1, P2</li>
</ul>
<p>All Camera APIs take in 3 common parameters apart from the API-specific ones, <code>camera_name</code>(str), <code>vehicle_name</code>(str) and <code>external</code>(bool, to indicate <a href="../settings/#external-cameras">External Camera</a>). Camera and vehicle name is used to get the specific camera, if <code>external</code> is set to <code>true</code>, then the vehicle name is ignored. Also see <a href="https://github.com/microsoft/AirSim/blob/main/PythonClient/computer_vision/external_camera.py">external_camera.py</a> for example usage of these APIs.</p>
<h3 id="gimbal">Gimbal<a class="headerlink" href="#gimbal" title="Permanent link">#</a></h3>
<p>You can set stabilization for pitch, roll or yaw for any camera <a href="../settings/#gimbal">using settings</a>.</p>
<p>Please see <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//computer_vision/cv_mode.py">example usage</a>.</p>
<h2 id="changing-resolution-and-camera-parameters">Changing Resolution and Camera Parameters<a class="headerlink" href="#changing-resolution-and-camera-parameters" title="Permanent link">#</a></h2>
<p>To change resolution, FOV etc, you can use <a href="../settings/">settings.json</a>. For example, below addition in settings.json sets parameters for scene capture and uses "Computer Vision" mode described above. If you omit any setting then below default values will be used. For more information see <a href="../settings/">settings doc</a>. If you are using stereo camera, currently the distance between left and right is fixed at 25 cm.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;SettingsVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;CameraDefaults&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;CaptureSettings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;ImageType&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;Width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;Height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">144</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;FOV_Degrees&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;AutoExposureSpeed&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;MotionBlurAmount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;SimMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ComputerVision&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="what-does-pixel-values-mean-in-different-image-types">What Does Pixel Values Mean in Different Image Types?<a class="headerlink" href="#what-does-pixel-values-mean-in-different-image-types" title="Permanent link">#</a></h2>
<h3 id="available-imagetype-values">Available ImageType Values<a class="headerlink" href="#available-imagetype-values" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="n">Scene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">DepthPlanar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">DepthPerspective</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">  </span><span class="n">DepthVis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">DisparityNormalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">  </span><span class="n">Segmentation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">  </span><span class="n">SurfaceNormals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">  </span><span class="n">Infrared</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">  </span><span class="n">OpticalFlow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">  </span><span class="n">OpticalFlowVis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span>
</code></pre></div>
<h3 id="depthplanar-and-depthperspective">DepthPlanar and DepthPerspective<a class="headerlink" href="#depthplanar-and-depthperspective" title="Permanent link">#</a></h3>
<p>You normally want to retrieve the depth image as float (i.e. set <code>pixels_as_float = true</code>) and specify <code>ImageType = DepthPlanar</code> or <code>ImageType = DepthPerspective</code> in <code>ImageRequest</code>. For <code>ImageType = DepthPlanar</code>, you get depth in camera plane, i.e., all points that are plane-parallel to the camera have same depth. For <code>ImageType = DepthPerspective</code>, you get depth from camera using a projection ray that hits that pixel. Depending on your use case, planner depth or perspective depth may be the ground truth image that you want. For example, you may be able to feed perspective depth to ROS package such as <code>depth_image_proc</code> to generate a point cloud. Or planner depth may be more compatible with estimated depth image generated by stereo algorithms such as SGM.</p>
<h3 id="depthvis">DepthVis<a class="headerlink" href="#depthvis" title="Permanent link">#</a></h3>
<p>When you specify <code>ImageType = DepthVis</code> in <code>ImageRequest</code>, you get an image that helps depth visualization. In this case, each pixel value is interpolated from black to white depending on depth in camera plane in meters. The pixels with pure white means depth of 100m or more while pure black means depth of 0 meters.</p>
<h3 id="disparitynormalized">DisparityNormalized<a class="headerlink" href="#disparitynormalized" title="Permanent link">#</a></h3>
<p>You normally want to retrieve disparity image as float (i.e. set <code>pixels_as_float = true</code> and specify <code>ImageType = DisparityNormalized</code> in <code>ImageRequest</code>) in which case each pixel is <code>(Xl - Xr)/Xmax</code>, which is thereby normalized to values between 0 to 1.</p>
<h3 id="segmentation">Segmentation<a class="headerlink" href="#segmentation" title="Permanent link">#</a></h3>
<p>When you specify <code>ImageType = Segmentation</code> in <code>ImageRequest</code>, you get an image that gives you ground truth segmentation of the scene. At the startup, AirSim assigns value 0 to 255 to each mesh available in environment. This value is then mapped to a specific color in <a href="https://github.com/microsoft/AirSim/blob/main/Unreal/Plugins/AirSim/Content/HUDAssets/seg_color_palette.png">the pallet</a>. The RGB values for each object ID can be found in <a href="../seg_rgbs.txt">this file</a>.</p>
<p>You can assign a specific value (limited to the range 0-255) to a specific mesh using APIs. For example, below Python code sets the object ID for the mesh called "Ground" to 20 in Blocks environment and hence changes its color in Segmentation view:</p>
<div class="highlight"><pre><span></span><code><span class="n">success</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simSetSegmentationObjectID</span><span class="p">(</span><span class="s2">&quot;Ground&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</code></pre></div>
<p>The return value is a boolean type that lets you know if the mesh was found.</p>
<p>Notice that typical Unreal environments, like Blocks, usually have many other meshes that comprises of same object, for example, "Ground_2", "Ground_3" and so on. As it is tedious to set object ID for all of these meshes, AirSim also supports regular expressions. For example, the code below sets all meshes which have names starting with "ground" (ignoring case) to 21 with just one line:</p>
<div class="highlight"><pre><span></span><code><span class="n">success</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simSetSegmentationObjectID</span><span class="p">(</span><span class="s2">&quot;ground[\w]*&quot;</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span>
</code></pre></div>
<p>The return value is true if at least one mesh was found using regular expression matching.</p>
<p>It is recommended that you request uncompressed image using this API to ensure you get precise RGB values for segmentation image:
<div class="highlight"><pre><span></span><code><span class="n">responses</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simGetImages</span><span class="p">([</span><span class="n">ImageRequest</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">AirSimImageType</span><span class="o">.</span><span class="n">Segmentation</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)])</span>
<span class="n">img1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">image_data_uint8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="c1">#get numpy array</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">img1d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">#reshape array to 3 channel image array H X W X 3</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">)</span> <span class="c1">#original image is fliped vertically</span>

<span class="c1">#find unique colors</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1">#red</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1">#green</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1">#blue  </span>
</code></pre></div></p>
<p>A complete ready-to-run example can be found in <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//computer_vision/segmentation.py">segmentation.py</a>.</p>
<h4 id="unsetting-object-id">Unsetting object ID<a class="headerlink" href="#unsetting-object-id" title="Permanent link">#</a></h4>
<p>An object's ID can be set to -1 to make it not show up on the segmentation image.</p>
<h4 id="how-to-find-mesh-names">How to Find Mesh Names?<a class="headerlink" href="#how-to-find-mesh-names" title="Permanent link">#</a></h4>
<p>To get desired ground truth segmentation you will need to know the names of the meshes in your Unreal environment. To do this, you will need to open up Unreal Environment in Unreal Editor and then inspect the names of the meshes you are interested in using the World Outliner. For example, below we see the mesh names for the ground in Blocks environment in right panel in the editor:</p>
<p><img alt="record screenshot" src="../images/unreal_editor_blocks.png" /></p>
<p>If you don't know how to open Unreal Environment in Unreal Editor then try following the guide for <a href="../build_windows/">building from source</a>.</p>
<p>Once you decide on the meshes you are interested, note down their names and use above API to set their object IDs. There are <a href="../settings/#segmentation-settings">few settings</a> available to change object ID generation behavior.</p>
<h4 id="changing-colors-for-object-ids">Changing Colors for Object IDs<a class="headerlink" href="#changing-colors-for-object-ids" title="Permanent link">#</a></h4>
<p>At present the color for each object ID is fixed as in <a href="https://github.com/microsoft/AirSim/blob/main/Unreal/Plugins/AirSim/Content/HUDAssets/seg_color_palette.png">this pallet</a>. We will be adding ability to change colors for object IDs to desired values shortly. In the meantime you can open the segmentation image in your favorite image editor and get the RGB values you are interested in.</p>
<h4 id="startup-object-ids">Startup Object IDs<a class="headerlink" href="#startup-object-ids" title="Permanent link">#</a></h4>
<p>At the start, AirSim assigns object ID to each object found in environment of type <code>UStaticMeshComponent</code> or <code>ALandscapeProxy</code>. It then either uses mesh name or owner name (depending on settings), lower cases it, removes any chars below ASCII 97 to remove numbers and some punctuations, sums int value of all chars and modulo 255 to generate the object ID. In other words, all object with same alphabet chars would get same object ID. This heuristic is simple and effective for many Unreal environments but may not be what you want. In that case, please use above APIs to change object IDs to your desired values. There are <a href="../settings/#segmentation-settings">few settings</a> available to change this behavior.</p>
<h4 id="getting-object-id-for-mesh">Getting Object ID for Mesh<a class="headerlink" href="#getting-object-id-for-mesh" title="Permanent link">#</a></h4>
<p>The <code>simGetSegmentationObjectID</code> API allows you get object ID for given mesh name.</p>
<h3 id="infrared">Infrared<a class="headerlink" href="#infrared" title="Permanent link">#</a></h3>
<p>Currently this is just a map from object ID to grey scale 0-255. So any mesh with object ID 42 shows up with color (42, 42, 42). Please see <a href="#segmentation">segmentation section</a> for more details on how to set object IDs. Typically noise setting can be applied for this image type to get slightly more realistic effect. We are still working on adding other infrared artifacts and any contributions are welcome.</p>
<h3 id="opticalflow-and-opticalflowvis">OpticalFlow and OpticalFlowVis<a class="headerlink" href="#opticalflow-and-opticalflowvis" title="Permanent link">#</a></h3>
<p>These image types return information about motion perceived by the point of view of the camera. OpticalFlow returns a 2-channel image where the channels correspond to vx and vy respectively. OpticalFlowVis is similar to OpticalFlow but converts flow data to RGB for a more 'visual' output.</p>
<h2 id="example-code">Example Code<a class="headerlink" href="#example-code" title="Permanent link">#</a></h2>
<p>A complete example of setting vehicle positions at random locations and orientations and then taking images can be found in <a href="https://github.com/Microsoft/AirSim/tree/main/Examples/DataCollection/StereoImageGenerator.hpp">GenerateImageGenerator.hpp</a>. This example generates specified number of stereo images and ground truth disparity image and saving it to <a href="../pfm/">pfm format</a>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../apis/" class="btn btn-neutral float-left" title="核心 APIs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../apis_cpp/" class="btn btn-neutral float-right" title="C++ APIs">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>OpenHUTB 版权所有 &copy; 2025</p>
  </div>

</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../apis/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../apis_cpp/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
